"0","library(catboost)"
"0","set.seed(210)"
"0","folds <- createFolds(y = data_MCPD$dietaryMCPD, k = K)"
"0",""
"0","# Initialize the result data frame"
"0","result.train <- data.frame(RMSE = numeric(K), R2 = numeric(K), MAE = numeric(K))"
"0","result.test <- data.frame(RMSE = numeric(K), R2 = numeric(K), MAE = numeric(K))"
"0",""
"0","for (i in 1:K) {"
"0","  fold.test <- data_MCPD[folds[[i]], ]"
"0","  fold.train <- data_MCPD[-folds[[i]], ]"
"0","  "
"0","  # Prepare the CatBoost data pool"
"0","  train_pool <- catboost.load_pool(data = fold.train[, -1], "
"0","                                   label = as.matrix(fold.train[, 1]))	"
"0","  test_pool <- catboost.load_pool(data = fold.test[, -1], "
"0","                                  label = as.matrix(fold.test[, 1]))"
"0","  "
"0","  # Set the parameters of the CatBoost model"
"0","  output <- capture.output({"
"0","  model.cat <- catboost.train(train_pool,"
"0","                              params = best_param_cat)"
"0","  })"
"0","  "
"0","  # Performance for training set"
"0","  trainpred <- catboost.predict(model.cat, train_pool)"
"0","  temp.train <- defaultSummary(data.frame(obs = fold.train$dietaryMCPD, pred = trainpred))"
"0","  result.train[i, ] <- c(temp.train[""RMSE""], temp.train[""Rsquared""], temp.train[""MAE""])"
"0","  "
"0","  # Performance for test set"
"0","  testpred <- catboost.predict(model.cat, test_pool)"
"0","  temp.test <- defaultSummary(data.frame(obs = fold.test$dietaryMCPD, pred = testpred))"
"0","  result.test[i, ] <- c(temp.test[""RMSE""], temp.test[""Rsquared""], temp.test[""MAE""])"
"0","}"
"0",""
"0","R2_CAT <- result.test$R2"
"0","RMSE_CAT <- result.test$RMSE"
"0","MAE_CAT <- result.test$MAE"
"0",""
"0","Result_total[7, ] <- c("
"0","  'CAT',"
"0","  mean(result.train$RMSE),"
"0","  mean(result.train$R2),"
"0","  mean(result.train$MAE),"
"0","  mean(result.test$RMSE),"
"0","  mean(result.test$R2),"
"0","  mean(result.test$MAE)"
"0",")"
