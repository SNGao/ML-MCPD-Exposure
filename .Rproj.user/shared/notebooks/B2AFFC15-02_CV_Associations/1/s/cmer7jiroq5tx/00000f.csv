"0","set.seed(20240616)"
"0","folds <- createFolds(data_MCPD$dietaryMCPD, k = K)"
"0",""
"0","# Initialize the result data frame"
"0","result.train <- data.frame(RMSE = numeric(K), R2 = numeric(K), MAE = numeric(K))"
"0","result.test <- data.frame(RMSE = numeric(K), R2 = numeric(K), MAE = numeric(K))"
"0",""
"0","for (i in 1:K) {"
"0","  fold.test <- data_MCPD[folds[[i]], ]"
"0","  fold.train <- data_MCPD[-folds[[i]], ]"
"0","  "
"0","  # Train model"
"0","  model.gam <- gam(dietaryMCPD~CREATININE+HEIGHT+BMI+age"
"0","                             + bs(BEANOILintake) + bs(PEANUTOIintake) + bs(LARDOILintake) "
"0","                             + bs(MET) + DHPMA_a + bs(totalenergy)"
"0","                             + MARRIAGE + SEX + FAMINCOM5w + CVD + SMOKE        "
"0","                             + HBP+alcohol+education"
"0","                             , data = fold.train)"
"0","  "
"0","  # Performance for training set"
"0","  trainpred <- predict(model.gam, newdata = fold.train)"
"0","  temp.train <- defaultSummary(data.frame(obs = fold.train$dietaryMCPD, pred = trainpred))"
"0","  result.train[i, ] <- c(temp.train[""RMSE""], temp.train[""Rsquared""], temp.train[""MAE""])"
"0","  "
"0","  # Performance for test set"
"0","  testpred <- predict(model.gam, newdata = fold.test)"
"0","  temp.test <- defaultSummary(data.frame(obs = fold.test$dietaryMCPD, pred = testpred))"
"0","  result.test[i, ] <- c(temp.test[""RMSE""], temp.test[""Rsquared""], temp.test[""MAE""])"
"0","}"
"2","Warning: some 'x' values beyond boundary knots may cause ill-conditioned bases"
"2","Warning: some 'x' values beyond boundary knots may cause ill-conditioned bases"
"2","Warning: some 'x' values beyond boundary knots may cause ill-conditioned bases"
"2","Warning: some 'x' values beyond boundary knots may cause ill-conditioned bases"
"2","Warning: some 'x' values beyond boundary knots may cause ill-conditioned bases"
"2","Warning: some 'x' values beyond boundary knots may cause ill-conditioned bases"
"0","# Extract R2, RMSE, and MAE of the test set"
"0","R2_GAM.train <- result.train$R2"
"0","RMSE_GAM.train <- result.train$RMSE"
"0","MAE_GAM.train <- result.train$MAE"
"0",""
"0","R2_GAM.test <- result.test$R2"
"0","RMSE_GAM.test <- result.test$RMSE"
"0","MAE_GAM.test <- result.test$MAE"
"0",""
"0","Result_total[2, ] <- c("
"0","  'GAM',"
"0","  mean(result.train$RMSE),"
"0","  mean(result.train$R2),"
"0","  mean(result.train$MAE),"
"0","  mean(result.test$RMSE),"
"0","  mean(result.test$R2),"
"0","  mean(result.test$MAE)"
"0",")"
