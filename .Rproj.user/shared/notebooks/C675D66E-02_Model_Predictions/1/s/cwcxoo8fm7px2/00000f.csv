"0","set.seed(210)"
"0","# Create a lgb.Dataset object for train Model"
"0","train_data <- lgb.Dataset(data = as.matrix(X_train), label = as.matrix(y_train))"
"0",""
"0","# Random search by cross-validation"
"0","best_param_lgb <- list()"
"0","best_mse_lgb = Inf"
"0","best_iter_lgb = 0"
"0",""
"0","for (i in 1:100) {  # Number of random parameter combinations to try"
"0","  params <- lapply(param_grid, function(x) sample(x, 1))"
"0","  "
"0","  cv_results <- lgb.cv("
"0","    data = train_data,"
"0","    params = params,"
"0","    nrounds = 1000,"
"0","    early_stopping_rounds = 10,"
"0","    nfold = 5,"
"0","    verbose = -1,"
"0","  )"
"0","  mse <- cv_results$record_evals$valid$l2$eval[[cv_results$best_iter]]"
"0","  "
"0","  if (mse < best_mse_lgb) {"
"0","    best_param_lgb <- params"
"0","    best_mse_lgb <- mse"
"0","    best_iter_lgb <- cv_results$best_iter"
"0","  }"
"0","}"
"0",""
"0","print(list(best_mse_lgb, best_iter_lgb))"
"1","[[1]]
"
"1","[1]"
"1"," 0.01445979"
"1","
"
"1","
"
"1","[[2]]
"
"1","[1]"
"1"," 345"
"1","
"
"1","
"
