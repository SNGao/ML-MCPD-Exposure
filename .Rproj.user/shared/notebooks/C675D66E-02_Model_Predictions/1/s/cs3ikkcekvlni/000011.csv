"0","set.seed(1)"
"0","dtrain <- xgb.DMatrix(data = as.matrix(X_train), label = as.matrix(y_train))"
"0",""
"0","# Random search by cross-validation"
"0","best_params_xgb <- list()"
"0","best_rmse_xgb = Inf"
"0",""
"0","for (i in 1:2) {  # Number of random parameter combinations to try"
"0","  params <- lapply(param_grid, function(x) sample(x, 1))"
"0","  "
"0","  cv_results <- xgb.cv("
"0","    data = dtrain,"
"0","    params = params,"
"0","    nrounds = params$nrounds,"
"0","    early_stopping_rounds = 10,"
"0","    nfold = 5,"
"0","    verbose = 0,"
"0","  )"
"0","  rmse <- min(cv_results$evaluation_log$test_rmse_mean)"
"0","  "
"0","  if (rmse < best_rmse_xgb) {"
"0","    best_param_xgb <- params"
"0","    best_rmse_xgb <- rmse"
"0","    best_iter_xgb <- cv_results$best_iteration"
"0","  }"
"0","}"
