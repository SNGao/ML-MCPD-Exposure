"0","library(here)"
"0","library(forestploter)"
"0","library(grid)"
"0","# Define theme"
"0","tm <- forest_theme(base_size = 10,"
"0","                   refline_col = ""red"","
"0","                   footnote_col = ""#636363"","
"0","                   footnote_fontface = ""italic"","
"0","                   ci_Theight = 0.2)"
"0","## pre-process data"
"0","dat = readxl::read_xlsx('01_Output_Results/MLR4_forest_plot_dat.xlsx'); dat$X = NULL"
"0","dat$p.value <-"
"0","  ifelse(is.na(dat$p.value),"
"0","         """","
"0","         round(dat$p.value, 3))"
"0","dat$p.value <- ifelse(dat$p.value < 0.001 & dat$p.value != '', "
"0","                      '<0.001', dat$p.value)"
"0","dat$Variables = ifelse(grepl('vs', dat$Variables), paste0('  ', dat$Variables), dat$Variables)"
"0",""
"0","## Sort visulization order"
"0","dat$` ` <- paste(rep("" "", 20), collapse = "" "")"
"0","colnames(dat)[c(4)] = c('P value')"
"0","dat$`Coef (95%CI)` = ifelse(dat$`P value` == '',"
"0","                            '',"
"0","                            sprintf(""%.2f (%.2f, %.2f)"", dat$coef, dat$lower_CI, dat$upper_CI))"
"0","dat$`P value`[which(dat$`P value` == '0.83')] = '0.830'"
"0","dat$Variables[23] = paste0(""Urine creatinine ("", ""u"", 'mol/L)')"
"0",""
"0","## Exclude the second row for each variable"
"0","plot1 <- forest("
"0","  dat[, c(1, 7, 8, 4)],"
"0","  est = dat$coef,"
"0","  lower = dat$lower_CI,"
"0","  upper = dat$upper_CI,"
"0","  sizes = 0.4,"
"0","  ci_column = 2,"
"0","  ref_line = 0,"
"0","  font.family = ""Arial Unicode MS"","
"0","  xlim = c(-1, 1),"
"0","  ticks_at = c(-1, -0.5, 0, 0.5, 1),"
"0","  #x_trans = c(""log""),"
"0","  #arrow_lab = c(""Placebo Better"", ""Treatment Better""),"
"0","  #footnote = ""This is the demo data. Please feel free to change\nanything you want."","
"0","  theme = tm) |>"
"0","  edit_plot(row = c(1,2,4,7,9,11,14,16,18,20, 22:29),"
"0","            col = 1,"
"0","            gp = gpar(fontface = ""bold"")) |>"
"0","  add_border(part = ""header"", where = c(""bottom"")) |>"
"0","  add_border(part = ""header"", where = c(""top""))"
"0",""
"0","pdf('01_Output_Results/MLR_forest.pdf')"
"0","plot1"
