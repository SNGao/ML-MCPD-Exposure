"0","colnames(data_MCPD)"
"1"," [1]"
"1"," ""dietaryMCPD""   "
"1"," ""CREATININE""    "
"1"," ""HEIGHT""        "
"1"," ""BMI""           "
"1"," ""age""           "
"1"," ""BEANOILintake"" "
"1"," ""PEANUTOIintake"""
"1","
"
"1"," [8]"
"1"," ""LARDOILintake"" "
"1"," ""MET""           "
"1"," ""DHPMA_a""       "
"1"," ""totalenergy""   "
"1"," ""MARRIAGE""      "
"1"," ""SMOKE""         "
"1"," ""SEX""           "
"1","
"
"1","[15]"
"1"," ""FAMINCOM5w""    "
"1"," ""CVD""           "
"1"," ""db""            "
"1"," ""HBP""           "
"1"," ""alcohol""       "
"1"," ""education""     "
"1","
"
"0","varList <- c(""CREATININE"",""HEIGHT"",""BMI"",""age"",""BEANOILintake"","
"0","             ""PEANUTOIintake"",""LARDOILintake"",""MET"",""totalenergy"",'db',"
"0","             ""MARRIAGE"",""SMOKE"",""SEX"",""FAMINCOM5w"",""CVD"",""HBP"",""alcohol"",""education"")"
"0",""
"0","## Interaction Check"
"0","nonlinear.var = c('CREATININE', 'HEIGHT', 'MET', 'totalenergy')"
"0","results_BA_CES <- data.frame(Estimate = NA,"
"0","                             SE = NA,"
"0","                             T.value = NA,"
"0","                             P_value = NA,"
"0","                             R = NA)"
"0","for (var in varList){"
"0","  if (var %in% nonlinear.var){"
"0","    formula = as.formula(paste0('dietaryMCPD~ns(CREATININE, df = 2) +ns(HEIGHT, df = 2) + BMI + age + ns(BEANOILintake) +  ns(BEANOILintake) + ns(PEANUTOIintake) + ns(LARDOILintake)+ ns(MET, df = 2) + DHPMA_a+ ns(totalenergy, df = 2)+ MARRIAGE+SEX+FAMINCOM5w+CVD+SMOKE  + HBP+alcohol+education','+DHPMA_a:ns(', var,', df = 2)'))"
"0","  } else{"
"0","    formula = as.formula(paste0('dietaryMCPD~ns(CREATININE, df = 2) +ns(HEIGHT, df = 2) + BMI + age + ns(BEANOILintake) +  ns(BEANOILintake) + ns(PEANUTOIintake) + ns(LARDOILintake)+ ns(MET, df = 2) + DHPMA_a + ns(totalenergy, df = 2)+ MARRIAGE+SEX+FAMINCOM5w+CVD+SMOKE  + HBP+alcohol+education','+ DHPMA_a:', var))"
"0","  }"
"0","  "
"0","  fit <- lm(formula, data = data_MCPD)"
"0","  a = summary(fit); tmp = data.frame(a$coefficients)"
"0","  colnames(tmp) = c('Estimate', 'SE', 'T.value', 'P_value')"
"0","  tmp$R = a$r.squared"
"0","  "
"0","  ## Find Output Row Number"
"0","  num1 = grepl('DHPMA_a', row.names(tmp))"
"0","  num2 = grepl(var, row.names(tmp))"
"0","  num.all = num1 | num2"
"0","  "
"0","  results_BA_CES = rbind(results_BA_CES, tmp[num.all,])"
"0","}"
"0","results_BA_CES[-1,]"
