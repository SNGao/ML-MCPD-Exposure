"0","data.raw = read.csv('00_Data/data_MCPD.csv') # Generated from STATA files"
"0","dat.table = data.raw[row.names(data_MCPD),]"
"0","dat.table$MARRIAGE = ifelse(dat.table$MARRIAGE == 1, 3, dat.table$MARRIAGE)"
"0","write.csv(as.numeric(row.names(dat.table)), '01_Output_Results/Selected_list.csv')"
"0",""
"0","colnames(dat.table)"
"1"," [1]"
"1"," ""dietaryMCPD""   "
"1"," ""CREATININE""    "
"1"," ""WEIGHT""        "
"1"," ""HEIGHT""        "
"1"," ""BMI""           "
"1"," ""age""           "
"1"," ""BEANOILintake"" "
"1"," ""PEANUTOIintake"""
"1"," ""LARDOILintake"" "
"1","
"
"1","[10]"
"1"," ""MET""           "
"1"," ""DHPMA_a""       "
"1"," ""totalenergy""   "
"1"," ""MARRIAGE""      "
"1"," ""SMOKE""         "
"1"," ""SEX""           "
"1"," ""FAMINCOM5w""    "
"1"," ""CVD""           "
"1"," ""db""            "
"1","
"
"1","[19]"
"1"," ""HBP""           "
"1"," ""alcohol""       "
"1"," ""education""     "
"1","
"
"0","## Transform Variable Name"
"0","dat.table = dat.table |>"
"0","  rename(Age = age,"
"0","         DHPMA = DHPMA_a,"
"0","         Smoking = SMOKE,"
"0","         Income = FAMINCOM5w,"
"0","         DB = db,"
"0","         Married = MARRIAGE,"
"0","         Drinking = alcohol,"
"0","         Physical_Activity = MET) |>"
"0","  mutate(SEX = factor("
"0","      SEX,"
"0","      levels = c(1, 2),"
"0","      labels = c(""Men"", ""Women"")"
"0","    ))"
"0",""
"0","## Generate Table1 Summary"
"0","library(gtsummary)"
"0","library(flextable)"
"2","
Attaching package: ‘flextable’

"
"2","The following objects are masked from ‘package:gtsummary’:

    as_flextable, continuous_summary

"
"0","dat.table %>%"
"0","  select(Age, education, Married, SEX,"
"0","         Income, Smoking, Drinking,"
"0","         CVD, DB, HBP, Physical_Activity,"
"0","         BMI, DHPMA, dietaryMCPD,"
"0","         BEANOILintake, PEANUTOIintake, LARDOILintake, totalenergy) %>%"
"0","  tbl_summary("
"0","    by = ""SEX"","
"0","    statistic = list("
"0","      all_continuous() ~ ""{mean} ({sd})"","
"0","      all_categorical() ~ ""{n} ({p}%)"""
"0","    ),"
"0","    digits = list("
"0","      all_continuous() ~ c(2, 2),  # 保留两位小数"
"0","      all_categorical() ~ c(0, 2)  # 保留两位小数的百分比"
"0","    )) %>%"
"0","  add_overall() %>%"
"0","  add_p(test = list(all_continuous() ~ ""aov"","
"0","                    all_categorical() ~ ""chisq.test"")) %>%"
"0","  as_flex_table() %>%"
"0","  save_as_docx(path = ""01_Output_Results/Table1.docx"")"
