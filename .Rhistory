data_MCPD$fit = pred$fit
data_MCPD$lower = pred$lwr
data_MCPD$upper = pred$upr
dat.plot = data_MCPD
dat.plot$SEX = ifelse(dat.plot$SEX == 1, 'Male', 'Female')
pdf('01_Output_Results/MLR4_GroupBy_Sex.pdf', width = 8, height = 6)
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = SEX)) +
# geom_point(alpha = 0.6, size = 2) +
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +
labs(title = "Association between Dietray MCPD and DHPMA by HBP Status",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
#scale_x_continuous(limits = c(2,10)) +
scale_y_continuous(limits = c(2,4)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
dev.off()
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = SEX)) +
# geom_point(alpha = 0.6, size = 2) +
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +
labs(title = "Association between Dietray MCPD and DHPMA by HBP Status",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
#scale_x_continuous(limits = c(2,10)) +
scale_y_continuous(limits = c(2,4)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = SEX)) +
# geom_point(alpha = 0.6, size = 2) +
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +
labs(title = "Association between Dietray MCPD and DHPMA by HBP Status",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
#scale_x_continuous(limits = c(2,10)) +
#scale_y_continuous(limits = c(2,4)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
pred = data.frame(predict(model.MLR4, data_MCPD, interval = "confidence", level = 0.95))
data_MCPD$fit = pred$fit
data_MCPD$lower = pred$lwr
data_MCPD$upper = pred$upr
dat.plot = data_MCPD
dat.plot$SEX = ifelse(dat.plot$SEX == 1, 'Male', 'Female')
pdf('01_Output_Results/MLR4_GroupBy_Sex.pdf', width = 8, height = 6)
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = SEX)) +
# geom_point(alpha = 0.6, size = 2) +
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +
labs(title = "Association between Dietray MCPD and DHPMA by Sex",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
#scale_x_continuous(limits = c(2,10)) +
#scale_y_continuous(limits = c(2,4)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
dev.off()
ggplot(data = data_MCPD, aes(x = DHPMA_a, y = fit, color = HEIGHT_group)) +
# geom_point(alpha = 0.6, size = 2) +  # 调整点的透明度和大小
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +  # 添加线性拟合线和置信区间
labs(title = "Association between dietaryMCPD and DHPMA_a by HBP Status",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
#scale_x_continuous(limits = c(2,10)) +
# scale_y_continuous(limits = c(2,4)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
pred = data.frame(predict(model.mlr4.inter1, data_MCPD, interval = "confidence", level = 0.95))
data_MCPD$fit = pred$fit
data_MCPD$lower = pred$lwr
data_MCPD$upper = pred$upr
data_MCPD = data_MCPD |>
mutate(HEIGHT_group = case_when(
HEIGHT <= quantile(HEIGHT, c(0.33, 0.67))[1] ~ 'G1',
HEIGHT <= quantile(HEIGHT, c(0.33, 0.67))[2] ~ 'G2',
HEIGHT > quantile(HEIGHT, c(0.33, 0.67))[2] ~ 'G3'
))
ggplot(data = data_MCPD, aes(x = DHPMA_a, y = fit, color = HEIGHT_group)) +
# geom_point(alpha = 0.6, size = 2) +  # 调整点的透明度和大小
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +  # 添加线性拟合线和置信区间
labs(title = "Association between dietaryMCPD and DHPMA_a by HBP Status",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
#scale_x_continuous(limits = c(2,10)) +
# scale_y_continuous(limits = c(2,4)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
pred = data.frame(predict(model.mlr4.inter2, data_MCPD, interval = "confidence", level = 0.95))
data_MCPD$fit = pred$fit
data_MCPD$lower = pred$lwr
data_MCPD$upper = pred$upr
dat.plot = data_MCPD
dat.plot$HBP = ifelse(dat.plot$HBP == 0, 'No HBP', 'HBP')
#data_MCPD$HBP <- factor(data_MCPD$HBP, levels = c(0, 1), labels = c("No HBP", "HBP"))
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = HBP)) +
# geom_point(alpha = 0.6, size = 2) +  # 调整点的透明度和大小
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +  # 添加线性拟合线和置信区间
labs(title = "Association between Dietray MCPD and DHPMA by HBP statues",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
# scale_x_continuous(limits = c(2,10)) +
# scale_y_continuous(limits = c(2,4)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
pred = data.frame(predict(model.MLR4, data_MCPD, interval = "confidence", level = 0.95))
data_MCPD$fit = pred$fit
data_MCPD$lower = pred$lwr
data_MCPD$upper = pred$upr
dat.plot = data_MCPD
dat.plot$SEX = ifelse(dat.plot$SEX == 1, 'Male', 'Female')
pdf('01_Output_Results/MLR4_GroupBy_Sex.pdf', width = 8, height = 6)
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = SEX)) +
# geom_point(alpha = 0.6, size = 2) +
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +
labs(title = "Association between Dietray MCPD and DHPMA by Sex",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
#scale_x_continuous(limits = c(2,10)) +
#scale_y_continuous(limits = c(2,4)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
dev.off()
pred = data.frame(predict(model.MLR4, data_MCPD, interval = "confidence", level = 0.95))
data_MCPD$fit = pred$fit
data_MCPD$lower = pred$lwr
data_MCPD$upper = pred$upr
dat.plot = data_MCPD
dat.plot$SEX = ifelse(dat.plot$SEX == 1, 'Male', 'Female')
pdf('01_Output_Results/MLR4_GroupBy_Sex.pdf', width = 8, height = 4)
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = SEX)) +
# geom_point(alpha = 0.6, size = 2) +
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +
labs(title = "Association between Dietray MCPD and DHPMA by Sex",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
#scale_x_continuous(limits = c(2,10)) +
scale_y_continuous(limits = c(0.6,1.4)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
dev.off()
pred = data.frame(predict(model.MLR4, data_MCPD, interval = "confidence", level = 0.95))
data_MCPD$fit = pred$fit
data_MCPD$lower = pred$lwr
data_MCPD$upper = pred$upr
dat.plot = data_MCPD
dat.plot$SEX = ifelse(dat.plot$SEX == 1, 'Male', 'Female')
pdf('01_Output_Results/MLR4_GroupBy_Sex.pdf', width = 8, height = 6)
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = SEX)) +
# geom_point(alpha = 0.6, size = 2) +
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +
labs(title = "Association between Dietray MCPD and DHPMA by Sex",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
#scale_x_continuous(limits = c(2,10)) +
scale_y_continuous(limits = c(0.6,1.4)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
dev.off()
pred = data.frame(predict(model.MLR4, data_MCPD, interval = "confidence", level = 0.95))
data_MCPD$fit = pred$fit
data_MCPD$lower = pred$lwr
data_MCPD$upper = pred$upr
dat.plot = data_MCPD
dat.plot$SEX = ifelse(dat.plot$SEX == 1, 'Male', 'Female')
pdf('01_Output_Results/MLR4_GroupBy_Sex.pdf', width = 8, height = 6)
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = SEX)) +
# geom_point(alpha = 0.6, size = 2) +
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +
labs(title = "Association between Dietray MCPD and DHPMA by Sex",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
#scale_x_continuous(limits = c(2,10)) +
scale_y_continuous(limits = c(0.7,1.3)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
dev.off()
pred = data.frame(predict(model.MLR4, data_MCPD, interval = "confidence", level = 0.95))
data_MCPD$fit = pred$fit
data_MCPD$lower = pred$lwr
data_MCPD$upper = pred$upr
dat.plot = data_MCPD
dat.plot$SEX = ifelse(dat.plot$SEX == 1, 'Male', 'Female')
pdf('01_Output_Results/MLR4_GroupBy_Sex.pdf', width = 8, height = 6)
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = SEX)) +
# geom_point(alpha = 0.6, size = 2) +
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +
labs(title = "Association between Dietray MCPD and DHPMA by Sex",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
#scale_x_continuous(limits = c(2,10)) +
scale_y_continuous(limits = c(0.7,1.2)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
dev.off()
pred = data.frame(predict(model.MLR4, data_MCPD, interval = "confidence", level = 0.95))
data_MCPD$fit = pred$fit
data_MCPD$lower = pred$lwr
data_MCPD$upper = pred$upr
dat.plot = data_MCPD
dat.plot$SEX = ifelse(dat.plot$SEX == 1, 'Male', 'Female')
pdf('01_Output_Results/MLR4_GroupBy_Sex.pdf', width = 8, height = 6)
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = SEX)) +
# geom_point(alpha = 0.6, size = 2) +
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +
labs(title = "Association between Dietray MCPD and DHPMA by Sex",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
#scale_x_continuous(limits = c(2,10)) +
scale_y_continuous(limits = c(0.7,1.1)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
dev.off()
pred = data.frame(predict(model.mlr4.inter2, data_MCPD, interval = "confidence", level = 0.95))
data_MCPD$fit = pred$fit
data_MCPD$lower = pred$lwr
data_MCPD$upper = pred$upr
dat.plot = data_MCPD
dat.plot$HBP = ifelse(dat.plot$HBP == 0, 'No HBP', 'HBP')
#data_MCPD$HBP <- factor(data_MCPD$HBP, levels = c(0, 1), labels = c("No HBP", "HBP"))
pdf('01_Output_Results/MLR4_GroupBy_HBP.pdf', width = 8, height = 6)
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = HBP)) +
# geom_point(alpha = 0.6, size = 2) +  # 调整点的透明度和大小
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +  # 添加线性拟合线和置信区间
labs(title = "Association between Dietray MCPD and DHPMA by HBP statues",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
# scale_x_continuous(limits = c(2,10)) +
scale_y_continuous(limits = c(0.7,1.1)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
dev.off()
pred = data.frame(predict(model.mlr4.inter1, data_MCPD, interval = "confidence", level = 0.95))
data_MCPD$fit = pred$fit
data_MCPD$lower = pred$lwr
data_MCPD$upper = pred$upr
data_MCPD = data_MCPD |>
mutate(HEIGHT_group = case_when(
HEIGHT <= quantile(HEIGHT, c(0.33, 0.67))[1] ~ 'G1',
HEIGHT <= quantile(HEIGHT, c(0.33, 0.67))[2] ~ 'G2',
HEIGHT > quantile(HEIGHT, c(0.33, 0.67))[2] ~ 'G3'
))
dat.plot = data_MCPD
pdf('01_Output_Results/MLR4_GroupBy_HEIGHT.pdf', width = 8, height = 6)
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = HEIGHT_group)) +
# geom_point(alpha = 0.6, size = 2) +  # 调整点的透明度和大小
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +  # 添加线性拟合线和置信区间
labs(title = "Association between Dietray MCPD and DHPMA by Height groups",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
#scale_x_continuous(limits = c(2,10)) +
scale_y_continuous(limits = c(0.7,1.1)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
dev.off()
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = HBP)) +
# geom_point(alpha = 0.6, size = 2) +  # 调整点的透明度和大小
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +  # 添加线性拟合线和置信区间
labs(title = "Association between Dietray MCPD and DHPMA by HBP statues",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
# scale_x_continuous(limits = c(2,10)) +
scale_y_continuous(limits = c(0.7,1.1)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = HBP)) +
# geom_point(alpha = 0.6, size = 2) +  # 调整点的透明度和大小
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +  # 添加线性拟合线和置信区间
labs(title = "Association between Dietray MCPD and DHPMA by HBP statues",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
# scale_x_continuous(limits = c(2,10)) +
scale_y_continuous(limits = c(0.7,1.1)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
pred = data.frame(predict(model.mlr4.inter2, data_MCPD, interval = "confidence", level = 0.95))
data_MCPD$fit = pred$fit
data_MCPD$lower = pred$lwr
data_MCPD$upper = pred$upr
dat.plot = data_MCPD
dat.plot$HBP = ifelse(dat.plot$HBP == 0, 'No HBP', 'HBP')
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = HBP)) +
# geom_point(alpha = 0.6, size = 2) +  # 调整点的透明度和大小
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +  # 添加线性拟合线和置信区间
labs(title = "Association between Dietray MCPD and DHPMA by HBP statues",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
# scale_x_continuous(limits = c(2,10)) +
scale_y_continuous(limits = c(0.7,1.1)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = SEX)) +
# geom_point(alpha = 0.6, size = 2) +  # 调整点的透明度和大小
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +  # 添加线性拟合线和置信区间
labs(title = "Association between Dietray MCPD and DHPMA by HBP statues",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
# scale_x_continuous(limits = c(2,10)) +
scale_y_continuous(limits = c(0.7,1.1)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
table(data_MCPD$SEX, data_MCPD$HBP)
table(data_MCPD$SEX, data_MCPD$HEIGHT_group)
pred = data.frame(predict(model.mlr4.inter1, data_MCPD, interval = "confidence", level = 0.95))
data_MCPD$fit = pred$fit
data_MCPD$lower = pred$lwr
data_MCPD$upper = pred$upr
data_MCPD = data_MCPD |>
mutate(HEIGHT_group = case_when(
HEIGHT <= quantile(HEIGHT, c(0.33, 0.67))[1] ~ 'G1',
HEIGHT <= quantile(HEIGHT, c(0.33, 0.67))[2] ~ 'G2',
HEIGHT > quantile(HEIGHT, c(0.33, 0.67))[2] ~ 'G3'
))
dat.plot = data_MCPD
dat.plot$SEX = ifelse(dat.plot$SEX == 1, 'Male', 'Female')
pdf('01_Output_Results/MLR4_GroupBy_HEIGHT.pdf', width = 8, height = 6)
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = SEX)) +
# geom_point(alpha = 0.6, size = 2) +
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +
labs(title = "Association between Dietray MCPD and DHPMA by Height groups",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
#scale_x_continuous(limits = c(2,10)) +
scale_y_continuous(limits = c(0.7,1.1)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
dev.off()
pred = data.frame(predict(model.mlr4.inter2, data_MCPD, interval = "confidence", level = 0.95))
data_MCPD$fit = pred$fit
data_MCPD$lower = pred$lwr
data_MCPD$upper = pred$upr
dat.plot = data_MCPD
dat.plot$HBP = ifelse(dat.plot$HBP == 0, 'No HBP', 'HBP')
dat.plot$SEX = ifelse(dat.plot$SEX == 1, 'Male', 'Female')
#data_MCPD$HBP <- factor(data_MCPD$HBP, levels = c(0, 1), labels = c("No HBP", "HBP"))
pdf('01_Output_Results/MLR4_GroupBy_HBP.pdf', width = 8, height = 6)
ggplot(data = dat.plot, aes(x = DHPMA_a, y = fit, color = SEX)) +
# geom_point(alpha = 0.6, size = 2) +  # 调整点的透明度和大小
geom_smooth(method = "lm", se = TRUE, linetype = "dashed", size = 1) +  # 添加线性拟合线和置信区间
labs(title = "Association between Dietray MCPD and DHPMA by HBP statues",
x = "DHPMA",
y = "Dietary MCPD",
color = "HBP Status") +
# scale_x_continuous(limits = c(2,10)) +
scale_y_continuous(limits = c(0.7,1.1)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),  # 标题居中
axis.title = element_text(size = 14),  # 轴标签字体大小
axis.text = element_text(size = 12),  # 轴文本字体大小
legend.position = "bottom",  # 图例位置
legend.title = element_blank(),  # 移除图例标题
legend.text = element_text(size = 12)  # 图例文本字体大小
)
dev.off()
